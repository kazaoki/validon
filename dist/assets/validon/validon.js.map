{"version":3,"sources":["assets/validon/validon.js"],"names":["__validonUrlPath","document","currentScript","src","querySelector","replace","RegExp","location","origin","Validon","opt","validon","this","form","config","eachfire","errorgroup","errorposition","errortag","loadedFunc","startFunc","beforeFunc","afterFunc","finishFunc","urlPath","window","addEventListener","console","warn","style","pointerEvents","submitEvent","event","preventDefault","returnValue","send","attachEvent","querySelectorAll","length","elems","i","e","target","getAttribute","srcElement","eventName","eventNames","type","tagName","split","j","name","onerror","msg","url","line","col","error","hasOwnProperty","objectMerge","a","b","key","Object","prototype","toString","call","concat","callback","json","ret","_typeof","params","elements","hasFileApi","File","matches","match","Array","checked","paramSet","value","options","selectedIndex","files","push","size","targets","isSubmit","keys","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","JSON","parse","responseText","changes","elem","selected","indexOf","list","errors","org_name","raw_name","errorholder","parent","parentNode","toUpperCase","createElement","setAttribute","appendChild","insertBefore","childNodes","message","innerHTML","submit","open","setRequestHeader","responseType","stringify","setkey","merged","data","$f","retvar","back","backUrl","action","removeEventListener","detachEvent","o","TypeError","p","k","max","min","member","fromIndex","that","Len","Math"],"mappings":"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","file":"validon.js","sourcesContent":["\n/**\n * set url path\n */\nvar __validonUrlPath = (\n\tdocument.currentScript\n\t\t? document.currentScript.src\n\t\t: document.querySelector('script[src*=validon\\\\.js]').src\n\t)\n\t.replace(new RegExp('^'+location.origin), '')\n\t.replace(/[^\\/]+$/, '')\n;\n\n/**\n * コンストラクタ\n */\nfunction Validon(opt)\n{\n\tvar validon = this;\n\n\t// オプションセット\n\tvalidon.form          = opt.form\n\tvalidon.config        = opt.config\n\tvalidon.eachfire      = opt.eachfire || false\n\tvalidon.errorgroup    = opt.errorgroup || 'section'\n\tvalidon.errorposition = opt.errorposition || 'append'\n\tvalidon.errortag      = opt.errortag || '<div class=\"error\">$message</div>'\n\tvalidon.loadedFunc    = opt.loadedFunc  // コンストラクタ生成後に実行する関数\n\tvalidon.startFunc     = opt.startFunc   // 開始してすぐ実行する関数\n\tvalidon.beforeFunc    = opt.beforeFunc  // json送信直前に実行する関数\n\tvalidon.afterFunc     = opt.afterFunc   // json受信直後に実行する関数\n\tvalidon.finishFunc    = opt.finishFunc  // 処理完了後に実行する関数\n\n\t// URLパス設定\n\tvalidon.urlPath = __validonUrlPath\n\n\t// オンロードセット\n\twindow.addEventListener('load', function () {\n\n\t\t// 設定チェック\n\t\tvalidon.form = document.querySelector(validon.form)\n\t\tif(!validon.form){\n\t\t\tconsole.warn('Validon can not set up. Please set exists form query.')\n\t\t\treturn false\n\t\t}\n\t\tif(!validon.config){\n\t\t\tconsole.warn('Validon can not set up. Please set config.')\n\t\t\treturn false\n\t\t}\n\n\t\t// 対象フォームがクリック不可になっていたら困るので戻し\n\t\tvalidon.form.style.pointerEvents = ''\n\n\t\t// submitイベント登録\n\t\tvar submitEvent = function(event){\n\t\t\t(event.preventDefault) ? event.preventDefault() : event.returnValue = false\n\t\t\tvalidon.send()\n\t\t}\n\t\tif (validon.form.addEventListener) {\n\t\t\tvalidon.form.addEventListener('submit', submitEvent, false)\n\t\t} else if (validon.form.attachEvent) {\n\t\t\tvalidon.form.attachEvent('onsubmit', submitEvent)\n\t\t}\n\t\tvalidon.submitEvent = submitEvent\n\n\t\t// プロクシ指定属性の実装 : data-validon-proxy=\"xxx\"\n\t\tif(validon.form.querySelectorAll('[data-validon-proxy]').length) {\n\t\t\tvar elems = validon.form.querySelectorAll('[data-validon-proxy]')\n\t\t\tfor(var i=0; i<elems.length; i++) {\n\t\t\t\tif (elems[i].addEventListener) {\n\t\t\t\t\telems[i].addEventListener('change', function(e){ validon.send(e.target.getAttribute('data-validon-proxy')) }, false)\n\t\t\t\t} else if (elems[i].attachEvent) {\n\t\t\t\t\telems[i].attachEvent('onchange', function(e){ validon.send(e.srcElement.getAttribute('data-validon-proxy')) })\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// 要素ごとのイベント発火が有効の場合、各要素に `onChange` が登録され都度バリデートされるようになる。\n\t\t// ※要素ごとに設定も可能（例： data-validon-on='change,keydown' ← カンマで複数指定可\n\t\tif(validon.eachfire || validon.form.querySelectorAll('[data-validon-on]').length) {\n\t\t\tvar elems = validon.eachfire\n\t\t\t\t? validon.form.querySelectorAll('[name]')\n\t\t\t\t: validon.form.querySelectorAll('[data-validon-on]')\n\t\t\tfor(var i=0; i<elems.length; i++) {\n\t\t\t\tvar eventName = elems[i].getAttribute('data-validon-on')\n\t\t\t\tif(!eventName) {\n\t\t\t\t\tif(\n\t\t\t\t\t\telems[i].type==='radio' ||\n\t\t\t\t\t\telems[i].type==='checkbox' ||\n\t\t\t\t\t\telems[i].type==='file' ||\n\t\t\t\t\t\telems[i].tagName==='SELECT'\n\t\t\t\t\t) {\n\t\t\t\t\t\teventName = 'change'\n\t\t\t\t\t} else {\n\t\t\t\t\t\teventName = 'blur'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar eventNames = eventName.split(/\\s*\\,\\s*/)\n\t\t\t\tfor(var j=0; j<eventNames.length; j++) {\n\t\t\t\t\tvar event = eventNames[j];\n\t\t\t\t\tif (elems[i].addEventListener) {\n\t\t\t\t\t\telems[i].addEventListener(event, function(e){ validon.send(e.target.name) }, false)\n\t\t\t\t\t} else if (elems[i].attachEvent) {\n\t\t\t\t\t\telems[i].attachEvent('on'+event, function(e){ validon.send(e.srcElement.name) })\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// フック：loadedFunc\n\t\tif(validon.loadedFunc && 'function' === typeof validon.loadedFunc) {\n\t\t\tif(false === validon.loadedFunc()) return false\n\t\t}\n\t})\n\n\t// エラーが起きたら対象フォームのクリック解除\n\twindow.onerror = function(msg, url, line, col, error) {\n\t\tif(validon.form.hasOwnProperty('style')) {\n\t\t\tvalidon.form.style.pointerEvents = ''\n\t\t}\n\t}\n}\n\n/**\n * メソッド\n */\nValidon.prototype = {\n\n\t/**\n\t * PHPにデータを送信してバリデート実行\n\t *\n\t * - 引数空ならsubmit実行（全要素をバリデート対象にする\n\t * - 引数に文字列が入っている場合はnameとしてバリデート対象にする\n\t * - 引数に複数の文字列が配列で入っている場合は複数のnameとしてバリデート対象にする\n\t */\n\tsend: function(elems, callback){\n\t\tvar validon = this\n\t\tvar json = {\n\t\t\tconfig: this.config\n\t\t};\n\n\t\t// フック：startFunc\n\t\tif(validon.startFunc && 'function' === typeof validon.startFunc) {\n\t\t\tvar ret = validon.startFunc(json)\n\t\t\tif(false===ret) {\n\t\t\t\treturn false\n\t\t\t} else if('object'===(typeof ret)) {\n\t\t\t\tjson = ret\n\t\t\t}\n\t\t}\n\n\t\t// submit中は要素を全てクリックできないように\n\t\tif(typeof elems === 'undefined') validon.form.style.pointerEvents = 'none'\n\n\t\t// 値まとめ\n\t\tjson.params = []\n\t\tvar params = {}\n\t\tvar elements = validon.form.querySelectorAll('[name]')\n\t\tvar hasFileApi = !!window.File;\n\t\tfor(var i=0; i<elements.length; i++) {\n\n\t\t\tvar name = elements[i].getAttribute('name')\n\n\t\t\t// 各要素にとりあえず空をセットする（未選択要素でもajaxで飛ばしたいので）\n\t\t\tvar matches;\n\t\t\tif(matches = name.match(/^(.+?)\\[(.*)\\]$/)) {\n\t\t\t\tif(matches[2].length){\n\t\t\t\t\t// name=\"color[abc]\"\n\t\t\t\t\tif('object'!==typeof params[matches[1]]) params[matches[1]] = new Object()\n\t\t\t\t} else {\n\t\t\t\t\t// name=\"color[]\"\n\t\t\t\t\tif('object'!==typeof params[matches[1]]) params[matches[1]] = new Array()\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// name=\"color\"\n\t\t\t\tif('undefined'===typeof params[name]) params[name] = ''\n\t\t\t}\n\n\t\t\t// ラジオボタン or チェックボックス\n\t\t\tif(\n\t\t\t\t'radio'   ===elements[i].type ||\n\t\t\t\t'checkbox'===elements[i].type\n\t\t\t) {\n\t\t\t\tif(elements[i].checked) {\n\t\t\t\t\tthis.paramSet(params, name, elements[i].value)\n\t\t\t\t}\n\t\t\t}\n\t\t\t// セレクトプルダウン\n\t\t\telse if('SELECT'===elements[i].tagName) {\n\t\t\t\tif(''!==elements[i].options[elements[i].options.selectedIndex].value) {\n\t\t\t\t\tthis.paramSet(params, name, elements[i].options[elements[i].options.selectedIndex].value)\n\t\t\t\t}\n\t\t\t}\n\t\t\t// ファイル選択（FileAPIが使用できる場合は name,type,size をセットする）\n\t\t\telse if(elements[i].type==='file' && hasFileApi) {\n\t\t\t\tif(elements[i].files.length) {\n\t\t\t\t\tvar files = new Array();\n\t\t\t\t\tfor(var j=0; j<elements[i].files.length; j++){\n\t\t\t\t\t\tfiles.push({\n\t\t\t\t\t\t\tname: elements[i].files[j]['name'],\n\t\t\t\t\t\t\ttype: elements[i].files[j]['type'],\n\t\t\t\t\t\t\tsize: elements[i].files[j]['size'],\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tif(1===files.length) files=files[0] // 1つなら上へ上げる\n\t\t\t\t\tthis.paramSet(params, name, files)\n\t\t\t\t}\n\t\t\t}\n\t\t\t// その他の要素\n\t\t\telse {\n\t\t\t\tthis.paramSet(params, name, elements[i].value)\n\t\t\t}\n\t\t}\n\t\tjson.params = params\n\n\t\t// 対象要素まとめ\n\t\tjson.targets = []\n\t\tjson.isSubmit = false\n\t\tif(typeof elems === 'undefined') {\n\t\t\t// submitバリデートの場合全ての値\n\t\t\tjson.isSubmit = true\n\t\t\tjson.targets = Object.keys(json.params)\n\t\t} else if(typeof elems ==='string') {\n\t\t\t// 個別バリデート：単体の場合（要素ごとのバリデート発火など）\n\t\t\tjson.targets.push(elems)\n\t\t} else if(elems instanceof Array) {\n\t\t\t// 個別バリデート：複数の場合（直接jsからvalidate()実行など）\n\t\t\tfor(var i=0; i<elems.length; i++) {\n\t\t\t\tjson.targets.push(elems[i])\n\t\t\t}\n\t\t}\n\n\t\t// フック：beforeFunc\n\t\tif(validon.beforeFunc && 'function' === typeof validon.beforeFunc) {\n\t\t\tvar ret = validon.beforeFunc(json)\n\t\t\tif(false===ret) {\n\t\t\t\t// クリック不可を戻してイベントキャンセル\n\t\t\t\tif(typeof elems === 'undefined') validon.form.style.pointerEvents = ''\n\t\t\t\treturn false\n\t\t\t} else if('object'===(typeof ret)) {\n\t\t\t\tjson = ret\n\t\t\t}\n\t\t}\n\n\t\t// Ajax\n\t\tvar xhr = new XMLHttpRequest();\n\t\txhr.onreadystatechange = function()\n\t\t{\n\t\t\tif(4 === this.readyState) {\n\t\t\t\tif(200 === this.status) {\n\t\t\t\t\tjson = this.response\n\t\t\t\t\tif('undefined' === typeof json || 'string' === typeof json) {\n\t\t\t\t\t\tjson = JSON.parse(this.responseText)\n\t\t\t\t\t}\n\n\t\t\t\t\t// フック：afterFunc\n\t\t\t\t\tif(validon.afterFunc && 'function' === typeof validon.afterFunc) {\n\t\t\t\t\t\tvar ret = validon.afterFunc(json)\n\t\t\t\t\t\tif(false===ret) {\n\t\t\t\t\t\t\t// クリック不可を戻してイベントキャンセル\n\t\t\t\t\t\t\tif(typeof elems === 'undefined') validon.form.style.pointerEvents = ''\n\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t} else if('object'===(typeof ret)) {\n\t\t\t\t\t\t\tjson = ret\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// ターゲットのみ値の変更があれば反映する\n\t\t\t\t\tif(json.changes && json.changes.length) {\n\t\t\t\t\t\tfor(var i=0; i<json.changes.length; i++) {\n\t\t\t\t\t\t\tvar name = json.changes[i]\n\t\t\t\t\t\t\tvar elem = validon.form.querySelector('[name=\"'+name+'\"]')\n\t\t\t\t\t\t\tif(!elem) continue\n\t\t\t\t\t\t\tif(\n\t\t\t\t\t\t\t\t'INPUT' === elem.tagName &&\n\t\t\t\t\t\t\t\t('radio' === elem.getAttribute('type') || 'checkbox' === elem.getAttribute('type'))\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tvar elems = validon.form.querySelectorAll('[name=\"'+name+'\"]')\n\t\t\t\t\t\t\t\tfor(var j=0; j<elems.length; j++) {\n\t\t\t\t\t\t\t\t\telems[j].checked = -1 !== json.params[name].indexOf(elems[j].value)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if('SELECT' === elem.tagName) {\n\t\t\t\t\t\t\t\tvar options = elem.querySelectorAll('option')\n\t\t\t\t\t\t\t\tfor(var j=0; j<options.length; j++) {\n\t\t\t\t\t\t\t\t\toptions[j].selected = -1 !== json.params[name].indexOf(options[j].value)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\telem.value = json.params[name]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// ターゲットのみエラーがあれば反映する\n\t\t\t\t\tif(json.targets && json.targets.length) {\n\t\t\t\t\t\t// エラーにxxx[]が入ってくるようであれば、キーがxxxだけでも表示対象にするように。\n\t\t\t\t\t\tvar list = json.targets;\n\t\t\t\t\t\tfor(var i in list) {\n\t\t\t\t\t\t\tfor(var key in json.errors) {\n\t\t\t\t\t\t\t\tif(key.match(new RegExp('^'+list[i]+'\\\\\\['))) list.push(key)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// 開始\n\t\t\t\t\t\tfor(var i=0; i<list.length; i++) {\n\t\t\t\t\t\t\tvar name = list[i]\n\t\t\t\t\t\t\tvar org_name = name\n\t\t\t\t\t\t\tvar raw_name = name.replace(/\\[.*\\]/, '')\n\t\t\t\t\t\t\tvar errorholder = validon.form.querySelectorAll('[data-validon-errorholder=\"'+name+'\"]')\n\t\t\t\t\t\t\tif(!errorholder.length){\n\t\t\t\t\t\t\t\t// [] はずしたもので探す\n\t\t\t\t\t\t\t\tname = raw_name\n\t\t\t\t\t\t\t\terrorholder = validon.form.querySelectorAll('[data-validon-errorholder=\"'+name+'\"]')\n\n\t\t\t\t\t\t\t\t// 無ければ [] つけたもので探す\n\t\t\t\t\t\t\t\tif(!errorholder.length){\n\t\t\t\t\t\t\t\t\tname = raw_name+'[]'\n\t\t\t\t\t\t\t\t\terrorholder = validon.form.querySelectorAll('[data-validon-errorholder=\"'+name+'\"]')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// エラーホルダーが指定されてなければ自動で用意\n\t\t\t\t\t\t\tif(!errorholder.length) {\n\n\t\t\t\t\t\t\t\t// 対象要素探す\n\t\t\t\t\t\t\t\tvar elem = validon.form.querySelector('[name=\"'+raw_name+'\"]')\n\t\t\t\t\t\t\t\tif(!elem) {\n\t\t\t\t\t\t\t\t\t// なければ[]付きのを要素を探す\n\t\t\t\t\t\t\t\t\telem = validon.form.querySelector('[name^=\"'+raw_name+'[\"]')\n\t\t\t\t\t\t\t\t\tif(!elem) {\n\t\t\t\t\t\t\t\t\t\t// console.warn('Missing element: \"'+raw_name+'\"');\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// 対象要素の位置からエラーホルダーを生成する\n\t\t\t\t\t\t\t\tvar parent = elem.parentNode\n\t\t\t\t\t\t\t\twhile (parent.tagName !== validon.errorgroup.toUpperCase()) {\n\t\t\t\t\t\t\t\t\tparent = parent.parentNode;\n\t\t\t\t\t\t\t\t\tif('undefined' === typeof parent.tagName) {\n\t\t\t\t\t\t\t\t\t\tparent = elem.parentNode\n\t\t\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\terrorholder = document.createElement('div')\n\t\t\t\t\t\t\t\terrorholder.setAttribute('data-validon-errorholder', raw_name)\n\t\t\t\t\t\t\t\tif(validon.errorposition === 'append') {\n\t\t\t\t\t\t\t\t\tparent.appendChild(errorholder)\n\t\t\t\t\t\t\t\t} else if(validon.errorposition === 'prepend') {\n\t\t\t\t\t\t\t\t\tparent.insertBefore(errorholder, parent.childNodes[0]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\terrorholder = new Array(errorholder)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar message = ''\n\t\t\t\t\t\t\tif(Object.keys(json.errors).length && 'undefined' !== typeof json.errors[raw_name]) {\n\t\t\t\t\t\t\t\tmessage = validon.errortag.replace(/\\$message/, json.errors[raw_name])\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(Object.keys(json.errors).length && 'undefined' !== typeof json.errors[org_name]) {\n\t\t\t\t\t\t\t\tmessage = validon.errortag.replace(/\\$message/, json.errors[org_name])\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor(var j=0; j<errorholder.length; j++) {\n\t\t\t\t\t\t\t\terrorholder[j].innerHTML = message\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// 複数値[xxx]の場合はここで展開\n\t\t\t\t\t\t\tvar matches = org_name.match(/\\[([^\\[\\]]+)+\\]/)\n\t\t\t\t\t\t\tif(matches) {\n\t\t\t\t\t\t\t\tvar key = raw_name+'['+matches[1]+']'\n\t\t\t\t\t\t\t\tvar error = json.errors[key]\n\t\t\t\t\t\t\t\tif(error && error.length) {\n\t\t\t\t\t\t\t\t\tdocument.querySelector('[data-validon-errorholder=\"'+key+'\"]').innerHTML = validon.errortag.replace(/\\$message/, error)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// 第二引数に関数が指定されていたらここで実行\n\t\t\t\t\tif(callback && 'function' === typeof callback) {\n\t\t\t\t\t\tcallback(json)\n\t\t\t\t\t}\n\n\t\t\t\t\t// フック：finsihFunc\n\t\t\t\t\tif(validon.finishFunc && 'function' === typeof validon.finishFunc) {\n\t\t\t\t\t\tvar ret = validon.finishFunc(json)\n\t\t\t\t\t\tif(false===ret) {\n\t\t\t\t\t\t\t// クリック不可を戻してイベントキャンセル\n\t\t\t\t\t\t\tif(typeof elems === 'undefined') validon.form.style.pointerEvents = ''\n\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t} else if('object'===(typeof ret)) {\n\t\t\t\t\t\t\tjson = ret\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// エラーが一つも無ければsubmitする（isSubmit時のみ）\n\t\t\t\t\tif(!Object.keys(json.errors).length && json.isSubmit) validon.form.submit()\n\t\t\t\t\telse {\n\t\t\t\t\t\t// エラーがある場合はsubmit中のクリック不可を戻す\n\t\t\t\t\t\tif(typeof elems === 'undefined') validon.form.style.pointerEvents = ''\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn('Validon: '+this.status+' error return by validation.')\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\txhr.open('POST', validon.urlPath+'validon.php')\n\t\txhr.setRequestHeader('Content-Type', 'application/json')\n\t\txhr.responseType = 'json'\n\t\txhr.send(JSON.stringify(json))\n\n\t\treturn this\n\t},\n\n\t/**\n\t * params変数をセットするメソッド。キー名に[.*]がある場合は1次元まで配列にする。\n\t *\n\t * ex. color=red           -> params['color']   = 'red'\n\t * ex. color[]=red         -> params['color[]'] = ['red']\n\t * ex. color[123]=red      -> params['color[]'] = [{'123': 'red'}]\n\t * ex. color[123][456]=red -> params['color[]'] = [{'123[456]': 'red'}]\n\t */\n\tparamSet: function(params, name, value)\n\t{\n\t\t// 配列・オブジェクトに展開する再帰関数\n\t\tvar $f = function(key, value)\n\t\t{\n\t\t\tvar matches;\n\t\t\tif(matches = key.match(/^.*?\\[(.*?)\\](.*)$/)) {\n\t\t\t\tif(matches[1].length) {\n\t\t\t\t\tvar retvar = new Object()\n\t\t\t\t\tretvar[matches[1]] = matches[2]\n\t\t\t\t\t\t? $f(matches[2], value)\n\t\t\t\t\t\t: value\n\t\t\t\t\t;\n\t\t\t\t\treturn retvar\n\t\t\t\t} else {\n\t\t\t\t\tvar retvar = new Array()\n\t\t\t\t\tretvar.push(matches[2]\n\t\t\t\t\t\t? $f(matches[2], value)\n\t\t\t\t\t\t: value\n\t\t\t\t\t)\n\t\t\t\t\treturn retvar\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn value\n\t\t\t}\n\t\t}\n\n\t\t// セットするキー名生成\n\t\tvar setkey = name.replace(/\\[.*$/, '')\n\n\t\t// 既存のオブジェクトとマージ\n\t\tvar merged = objectMerge(\n\t\t\t{data: $f(name, value)},\n\t\t\t{data: params[setkey]}\n\t\t)\n\t\tparams[setkey] = merged['data']\n\t},\n\n\t/**\n\t * 戻るボタン押下用のメソッド\n\t *\n\t * バリデートを実施せずURLを書き換えてPOSTする\n\t * ex. <button type=\"button\" onclick=\"validon.back('/first.php')\">戻る</button>\n\t */\n\tback: function(backUrl){\n\t\tvalidon.form.action = backUrl;\n\t\tif (validon.form.removeEventListener) {\n\t\t\tvalidon.form.removeEventListener('submit', validon.submitEvent, false)\n\t\t} else if (validon.form.attachEvent) {\n\t\t\tvalidon.form.detachEvent('onsubmit', validon.submitEvent)\n\t\t}\n\t\tvalidon.form.submit()\n\t}\n}\n\n/**\n * Object.keys Polyfill\n * http://tokenposts.blogspot.com/2012/04/javascript-objectkeys-browser.html\n */\nif (!Object.keys) Object.keys = function(o) {\n\tif (o !== Object(o))\n\t\tthrow new TypeError('Object.keys called on a non-object');\n\tvar k=[],p;\n\tfor (p in o) if (Object.prototype.hasOwnProperty.call(o,p)) k.push(p);\n\treturn k;\n}\n\n/**\n * Array.indexOf Polyfill\n * https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf#Polyfill\n */\nif (!Array.prototype.indexOf) Array.prototype.indexOf = (function (Object, max, min) {\n\t\"use strict\";\n\treturn function indexOf(member, fromIndex) {\n\t\tif (this === null || this === undefined) throw TypeError(\"Array.prototype.indexOf called on null or undefined\");\n\t\tvar that = Object(this), Len = that.length >>> 0, i = min(fromIndex | 0, Len);\n\t\tif (i < 0) i = max(0, Len + i); else if (i >= Len) return -1;\n\t\tif (member === void 0) {\n\t\t\tfor (; i !== Len; ++i) if (that[i] === void 0 && i in that) return i; // undefined\n\t\t} else if (member !== member) {\n\t\t\tfor (; i !== Len; ++i) if (that[i] !== that[i]) return i; // NaN\n\t\t} else for (; i !== Len; ++i) if (that[i] === member) return i; // all else\n\t\treturn -1; // if the value was not found, then return -1\n\t};\n})(Object, Math.max, Math.min);\n\n/**\n * オブジェクトマージ関数\n * ※配列はconcat()される\n */\nfunction objectMerge(a, b) {\n\tfor (var key in b) {\n\t\tif (b.hasOwnProperty(key)) {\n\t\t\ta[key] = (key in a)\n\t\t\t\t? (\n\t\t\t\t\t(\n\t\t\t\t\t\tObject.prototype.toString.call(a[key]) === '[object Object]' &&\n\t\t\t\t\t\tObject.prototype.toString.call(b[key]) === '[object Object]'\n\t\t\t\t\t)\n\t\t\t\t\t\t? objectMerge(a[key], b[key])\n\t\t\t\t\t\t: (\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tObject.prototype.toString.call(a[key]) === '[object Array]' &&\n\t\t\t\t\t\t\t\tObject.prototype.toString.call(b[key]) === '[object Array]'\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t? b[key].concat(a[key])\n\t\t\t\t\t\t\t\t: a[key]\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t: b[key];\n\t\t}\n\t}\n\treturn a;\n};\n"]}