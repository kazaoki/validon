"use strict";var __validonUrlPath=(document.currentScript?document.currentScript.src:document.getElementsByTagName("script")[document.getElementsByTagName("script").length-1].src).replace(new RegExp("^"+location.origin),"").replace(/[^\/]+$/,"");function Validon(e){var o=this;o.form=e.form,o.config=e.config,o.eachfire=e.eachfire||!1,o.errortag=e.errortag||'<div class="error">$message</div>',o.position=e.position||"append",o.beforeFunc=e.beforeFunc,o.afterFunc=e.afterFunc,o.urlPath=__validonUrlPath;var t=window.onload||function(){if(o.form=document.querySelector(o.form),!o.form)return console.warn("Validon can not set up. Please set exists form query."),!1;if(!o.config)return console.warn("Validon can not set up. Please set config."),!1;if(o.form.addEventListener?o.form.addEventListener("submit",function(e){event.preventDefault?event.preventDefault():event.returnValue=!1,o.validon()},!1):o.form.attachEvent&&o.form.attachEvent("onsubmit",function(e){event.preventDefault?event.preventDefault():event.returnValue=!1,o.validon()}),o.eachfire)for(var e=o.form.querySelectorAll("[name]"),t=0;t<e.length;t++)e[t].getAttribute("data-validon-on")||("radio"===e[t].type||"checkbox"===e[t].type||"SELECT"===e[t].tagName?e[t].setAttribute("data-validon-on","change"):e[t].setAttribute("data-validon-on","blur"));for(e=o.form.querySelectorAll("[data-validon-on]"),t=0;t<e.length;t++){var n=e[t],r=n.getAttribute("data-validon-on");n.addEventListener?n.addEventListener(r,function(e){o.validon(this.name)},!1):n.attachEvent&&n.attachEvent("on"+r,function(e){o.validon(e.srcElement.name)})}};window.onload=function(){t()}}Validon.prototype={validon:function(e){for(var t=this,n={config:this.config,params:[]},r={},o=t.form.querySelectorAll("[name]"),a=0;a<o.length;a++){var i=o[a].getAttribute("name");if(void 0===r[i])if("radio"===o[a].type){var s=t.form.querySelectorAll('[name="'+i+'"]');for(a=0;a<s.length;a++)if(s[a].checked){r[i]=s[a].value;break}}else if("checkbox"===o[a].type){s=t.form.querySelectorAll('[name="'+i+'"]');for(r[i]=[],a=0;a<s.length;a++)s[a].checked&&r[i].push(s[a].value)}else if("SELECT"===o[a].tagName){s=t.form.querySelectorAll('[name="'+i+'"] option');for(r[i]=[],a=0;a<s.length;a++)s[a].selected&&r[i].push(s[a].value)}else r[i]=o[a].value}if(n.params=r,n.targets=[],void 0===e)n.targets=Object.keys(n.params);else if("string"==typeof e)n.targets.push(e);else if(e instanceof Array)for(a=0;a<e.length;a++)n.targets.push(e[a]);t.beforeFunc&&t.beforeFunc(n);var c=new XMLHttpRequest;return c.onreadystatechange=function(){4===this.readyState&&200===this.status&&(n=this.response,void 0===this.response&&(n=JSON.parse(this.responseText)),t.beforeFunc&&t.afterFunc(n))},c.open("POST",t.urlPath+"validon.php"),c.setRequestHeader("Content-Type","application/json"),c.responseType="json",c.send(JSON.stringify(n)),this}},Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on a non-object");var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return n});
//# sourceMappingURL=validon.js.map
