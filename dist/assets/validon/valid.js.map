{"version":3,"sources":["valid.js"],"names":["__validonUrlPath","document","currentScript","src","getElementsByTagName","length","replace","RegExp","location","origin","Validon","validon","eachfire","opt","position","form","config","urlPath","errortag","windowOnload","window","afterFunc","onload","querySelector","console","warn","event","preventDefault","elems","validate","e","returnValue","attachEvent","querySelectorAll","i","getAttribute","type","tagName","setAttribute","elem","srcElement","name","addEventListener","eventName","this","prototype","args","json","target","push","Array","indexOf","filter","x","self","beforeFunc","xhr","onreadystatechange","readyState","status","log","responseText","send","JSON","stringify","setRequestHeader","len","res","func","thisArg","t","c","TypeError","undefined","call","member","fromIndex","Object","max","min","that","Len","Math","lastIndexOf","searchElement","n","Number","arguments","floor","abs","k"],"mappings":"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","file":"valid.js","sourcesContent":["\n/**\n * set url path\n */\nvar __validonUrlPath = (\n\tdocument.currentScript\n\t\t? document.currentScript.src\n\t\t: document.getElementsByTagName('script')[document.getElementsByTagName('script').length-1].src\n\t)\n\t.replace(new RegExp('^'+location.origin), '')\n\t.replace(/[^\\/]+$/, '')\n;\n\n/**\n * コンストラクタ\n */\nfunction Validon(opt)\n{\n\tvar validon = this;\n\n\t// オプションセット\n\tvalidon.form       = opt.form\n\tvalidon.config     = opt.config\n\tvalidon.eachfire   = opt.eachfire || false\n\tvalidon.errortag   = opt.errortag || '<div class=\"error\">$message</div>'\n\tvalidon.position   = opt.position || 'append'\n\tvalidon.beforeFunc = opt.beforeFunc || 'append'\n\tvalidon.afterFunc  = opt.afterFunc || 'append'\n\n\t// URLパス設定\n\tvalidon.urlPath = __validonUrlPath\n\n\t// オンロードセット\n\tvar windowOnload = window.onload || function () {\n\n\t\t// 設定チェック\n\t\tvalidon.form = document.querySelector(validon.form)\n\t\tif(!validon.form){\n\t\t\tconsole.warn('Validon can not set up. Please set exists form query.')\n\t\t\treturn false\n\t\t}\n\t\tif(!validon.config){\n\t\t\tconsole.warn('Validon can not set up. Please set config.')\n\t\t\treturn false\n\t\t}\n\n\t\t// submitイベント登録\n\t\tif (validon.form.addEventListener) {\n\t\t\tvalidon.form.addEventListener('submit', function(e){\n\t\t\t\t(event.preventDefault) ? event.preventDefault() : event.returnValue = false;\n\t\t\t\tvalidon.validate()\n\t\t\t}, false);\n\t\t} else if (validon.form.attachEvent) {\n\t\t\tvalidon.form.attachEvent('onsubmit', function(e){\n\t\t\t\t(event.preventDefault) ? event.preventDefault() : event.returnValue = false;\n\t\t\t\tvalidon.validate()\n\t\t\t})\n\t\t}\n\n\t\t// 要素ごとのイベント発火の標準設定（ラジオ、チェックボックス、プルダウンはonChange、それ以外はonBlurとす）\n\t\t// 個別に指定したい場合は data-validon-on が優先になる。\n\t\tif(validon.eachfire) {\n\t\t\tvar elems = validon.form.querySelectorAll('[name]')\n\t\t\tfor(var i=0; i<elems.length; i++) {\n\t\t\t\tif(elems[i].getAttribute('data-validon-on')) continue\n\t\t\t\tif(elems[i].type==='radio' || elems[i].type==='checkbox' || elems[i].tagName==='SELECT') {\n\t\t\t\t\telems[i].setAttribute('data-validon-on', 'change')\n\t\t\t\t} else {\n\t\t\t\t\telems[i].setAttribute('data-validon-on', 'blur')\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// 個別イベント登録\n\t\tvar elems = validon.form.querySelectorAll('[data-validon-on]')\n\t\tfor(var i=0; i<elems.length; i++) {\n\t\t\tvar elem = elems[i]\n\t\t\tvar eventName = elem.getAttribute('data-validon-on')\n\t\t\tif (elem.addEventListener) {\n\t\t\t\telem.addEventListener(eventName, function(e){ validon.validate(this.name) }, false)\n\t\t\t} else if (elem.attachEvent) {\n\t\t\t\telem.attachEvent('on'+eventName, function(e){ validon.validate(e.srcElement.name) })\n\t\t\t}\n\t\t}\n\t};\n\twindow.onload = function () { windowOnload(); };\n}\n\n/**\n * メソッド\n */\nValidon.prototype = {\n\n\t/**\n\t * バリデート実行\n\t *\n\t * - 引数空ならsubmit実行（全要素をバリデート対象にする\n\t * - 引数に文字列が入っている場合はnameとしてバリデート対象にする\n\t * - 引数に複数の文字列が配列で入っている場合は複数のnameとしてバリデート対象にする\n\t */\n\tvalidate: function(args){\n\t\tvar validon = this\n\t\tvar json = [];\n\n\t\t// データまとめ\n\t\tjson.target = []\n\t\tif(typeof args ==='undefined') {\n\t\t\t// submitバリデートの場合全ての値\n\t\t\tvar elems = validon.form.querySelectorAll('[name]')\n\t\t\tfor(var i=0; i<elems.length; i++) {\n\t\t\t\tjson.target.push(elems[i].name)\n\t\t\t}\n\t\t} else if(typeof args ==='string') {\n\t\t\t// 個別バリデート：単体の場合（要素ごとのバリデート発火など）\n\t\t\tjson.target.push(args)\n\t\t} else if(args instanceof Array) {\n\t\t\t// 個別バリデート：複数の場合（直接jsからvalidate()実行など）\n\t\t\tfor(var i=0; i<args.length; i++) {\n\t\t\t\tjson.target.push(args[i])\n\t\t\t}\n\t\t}\n\t\t// 重複除去\n\t\tjson.target = json.target.filter(function (x, i, self) {\n\t\t\treturn self.indexOf(x) === i;\n\t\t});\n\n\t\t// フック：beforeFunc\n\t\tif(validon.beforeFunc) validon.beforeFunc(json)\n\n\t\t// Ajax\n\t\tvar xhr = new XMLHttpRequest();\n\t\txhr.onreadystatechange = function() {\n\t\t\tif(4===this.readyState && 200===this.status) {\n\n\t\t\t\tconsole.log(this.responseText);\n\n\t\t\t\t// フック：afterFunc\n\t\t\t\tif(validon.beforeFunc) validon.afterFunc(json)\n\n\t\t\t}\n\t\t}\n\t\txhr.open('POST', validon.urlPath+'valid.php');\n\t\txhr.setRequestHeader('Content-Type', 'application/json');\n\t\txhr.send(JSON.stringify(json));\n\n\n\n\t\treturn this\n\t}\n}\n\n/**\n * filterのPolyfill\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter#Polyfill\n */\nif (!Array.prototype.filter) {\n\tArray.prototype.filter = function (func, thisArg) {\n\t\t'use strict';\n\t\tif (!((typeof func === 'Function' || typeof func === 'function') && this))\n\t\t\tthrow new TypeError();\n\t\tvar len = this.length >>> 0,\n\t\t\tres = new Array(len), // preallocate array\n\t\t\tt = this, c = 0, i = -1;\n\t\tif (thisArg === undefined) {\n\t\t\twhile (++i !== len) {\n\t\t\t\t// checks to see if the key was set\n\t\t\t\tif (i in this) {\n\t\t\t\t\tif (func(t[i], i, t)) {\n\t\t\t\t\t\tres[c++] = t[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\twhile (++i !== len) {\n\t\t\t\t// checks to see if the key was set\n\t\t\t\tif (i in this) {\n\t\t\t\t\tif (func.call(thisArg, t[i], i, t)) {\n\t\t\t\t\t\tres[c++] = t[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tres.length = c; // shrink down array to proper size\n\t\treturn res;\n\t};\n}\n\n/**\n * indexOfのPolyfill\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf#Polyfill\n */\nif (!Array.prototype.indexOf) Array.prototype.indexOf = (function (Object, max, min) {\n\t\"use strict\";\n\treturn function indexOf(member, fromIndex) {\n\t\tif (this === null || this === undefined) throw TypeError(\"Array.prototype.indexOf called on null or undefined\");\n\t\tvar that = Object(this), Len = that.length >>> 0, i = min(fromIndex | 0, Len);\n\t\tif (i < 0) i = max(0, Len + i); else if (i >= Len) return -1;\n\t\tif (member === void 0) {\n\t\t\tfor (; i !== Len; ++i) if (that[i] === void 0 && i in that) return i; // undefined\n\t\t} else if (member !== member) {\n\t\t\tfor (; i !== Len; ++i) if (that[i] !== that[i]) return i; // NaN\n\t\t} else for (; i !== Len; ++i) if (that[i] === member) return i; // all else\n\t\treturn -1; // if the value was not found, then return -1\n\t};\n})(Object, Math.max, Math.min);\n\n/**\n * lastIndexOfのPolyfill\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/lastIndexOf#Polyfill\n */\nif (!Array.prototype.lastIndexOf) {\n\tArray.prototype.lastIndexOf = function (searchElement /*, fromIndex*/) {\n\t\t'use strict';\n\t\tif (this === void 0 || this === null) {\n\t\t\tthrow new TypeError();\n\t\t}\n\t\tvar n, k,\n\t\t\tt = Object(this),\n\t\t\tlen = t.length >>> 0;\n\t\tif (len === 0) {\n\t\t\treturn -1;\n\t\t}\n\t\tn = len - 1;\n\t\tif (arguments.length > 1) {\n\t\t\tn = Number(arguments[1]);\n\t\t\tif (n != n) {\n\t\t\t\tn = 0;\n\t\t\t}\n\t\t\telse if (n != 0 && n != (1 / 0) && n != -(1 / 0)) {\n\t\t\t\tn = (n > 0 || -1) * Math.floor(Math.abs(n));\n\t\t\t}\n\t\t}\n\t\tfor (k = n >= 0 ? Math.min(n, len - 1) : len - Math.abs(n); k >= 0; k--) {\n\t\t\tif (k in t && t[k] === searchElement) {\n\t\t\t\treturn k;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t};\n}\n"]}