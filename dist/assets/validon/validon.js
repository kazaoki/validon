"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},__validonUrlPath=(document.currentScript?document.currentScript.src:document.getElementsByTagName("script")[document.getElementsByTagName("script").length-1].src).replace(new RegExp("^"+location.origin),"").replace(/[^\/]+$/,"");function Validon(e){var a=this;a.form=e.form,a.config=e.config,a.eachfire=e.eachfire||!1,a.errortag=e.errortag||'<div class="error">$message</div>',a.position=e.position||"append",a.beforeFunc=e.beforeFunc,a.afterFunc=e.afterFunc,a.urlPath=__validonUrlPath;var t=window.onload||function(){if(a.form=document.querySelector(a.form),!a.form)return console.warn("Validon can not set up. Please set exists form query."),!1;if(!a.config)return console.warn("Validon can not set up. Please set config."),!1;var e=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,a.send()};if(a.form.addEventListener?a.form.addEventListener("submit",e,!1):a.form.attachEvent&&a.form.attachEvent("onsubmit",e),a.eachfire)for(var t=a.form.querySelectorAll("[name]"),n=0;n<t.length;n++)t[n].getAttribute("data-validon-on")||("radio"===t[n].type||"checkbox"===t[n].type||"SELECT"===t[n].tagName?t[n].setAttribute("data-validon-on","change"):t[n].setAttribute("data-validon-on","blur"));for(t=a.form.querySelectorAll("[data-validon-on]"),n=0;n<t.length;n++){var r=t[n],o=r.getAttribute("data-validon-on");r.addEventListener?r.addEventListener(o,function(e){a.send(this.name)},!1):r.attachEvent&&r.attachEvent("on"+o,function(e){a.send(e.srcElement.name)})}};window.onload=function(){t()}}Validon.prototype={send:function(e,t){for(var n=this,r={config:this.config,params:[]},o={},a=(e=n.form.querySelectorAll("[name]"),0);a<e.length;a++){var i=e[a].getAttribute("name");if(void 0===o[i])if("radio"===e[a].type){var s=n.form.querySelectorAll('[name="'+i+'"]');for(a=0;a<s.length;a++)if(s[a].checked){o[i]=s[a].value;break}}else if("checkbox"===e[a].type){s=n.form.querySelectorAll('[name="'+i+'"]');for(o[i]=[],a=0;a<s.length;a++)s[a].checked&&o[i].push(s[a].value)}else if("SELECT"===e[a].tagName){s=n.form.querySelectorAll('[name="'+i+'"] option');for(o[i]=[],a=0;a<s.length;a++)s[a].selected&&o[i].push(s[a].value)}else o[i]=e[a].value}if(r.params=o,r.targets=[],r.isSubmit=!1,void 0===e)r.isSubmit=!0,r.targets=Object.keys(r.params);else if("string"==typeof e)r.targets.push(e);else if(e instanceof Array)for(a=0;a<e.length;a++)r.targets.push(e[a]);if(n.beforeFunc&&!1===n.beforeFunc(r))return!1;var c=new XMLHttpRequest;return c.onreadystatechange=function(){if(4===this.readyState&&200===this.status){if(r=this.response,void 0===this.response&&(r=JSON.parse(this.responseText)),!1===n.afterFunc(r))return!1;t&&(void 0===t||_typeof(t))&&t(r)}},c.open("POST",n.urlPath+"validon.php"),c.setRequestHeader("Content-Type","application/json"),c.responseType="json",c.send(JSON.stringify(r)),this}},Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on a non-object");var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return n});
//# sourceMappingURL=validon.js.map
