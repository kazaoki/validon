{"version":3,"sources":["validon.js"],"names":["__validonUrlPath","document","currentScript","src","getElementsByTagName","length","replace","RegExp","location","origin","Validon","validon","eachfire","opt","errorposition","beforeFunc","afterFunc","finishFunc","errorgroup","urlPath","startFunc","windowOnload","window","onload","form","querySelector","console","warn","config","submitEvent","addEventListener","attachEvent","event","preventDefault","returnValue","send","querySelectorAll","elems","eventName","eventNames","split","j","i","type","tagName","e","this","name","srcElement","prototype","json","params","elements","getAttribute","style","pointerEvents","hasFileApi","lump","checked","Array","value","match","push","element","files","size","isSubmit","targets","Object","keys","xhr","XMLHttpRequest","readyState","onreadystatechange","status","response","JSON","parse","responseText","changes","elem","options","selected","indexOf","parent","parentNode","errorholder","createElement","setAttribute","appendChild","insertBefore","childNodes","message","callback","errors","errortag","open","submit","o","TypeError","k","responseType","p","stringify","hasOwnProperty","call","that","max","min","member","fromIndex","Len","Math"],"mappings":"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","file":"validon.js","sourcesContent":["\n/**\n * set url path\n */\nvar __validonUrlPath = (\n\tdocument.currentScript\n\t\t? document.currentScript.src\n\t\t: document.getElementsByTagName('script')[document.getElementsByTagName('script').length-1].src\n\t)\n\t.replace(new RegExp('^'+location.origin), '')\n\t.replace(/[^\\/]+$/, '')\n;\n\n/**\n * コンストラクタ\n */\nfunction Validon(opt)\n{\n\tvar validon = this;\n\n\t// オプションセット\n\tvalidon.form          = opt.form\n\tvalidon.config        = opt.config\n\tvalidon.eachfire      = opt.eachfire || false\n\tvalidon.errorgroup    = opt.errorgroup || 'section'\n\tvalidon.errorposition = opt.errorposition || 'append'\n\tvalidon.errortag      = opt.errortag || '<div class=\"error\">$message</div>'\n\tvalidon.startFunc     = opt.startFunc  // 開始してすぐ実行する関数\n\tvalidon.beforeFunc    = opt.beforeFunc // json送信直前に実行する関数\n\tvalidon.afterFunc     = opt.afterFunc  // json受信直後に実行する関数\n\tvalidon.finishFunc    = opt.finishFunc // 処理完了後に実行する関数\n\n\t// URLパス設定\n\tvalidon.urlPath = __validonUrlPath\n\n\t// オンロードセット\n\tvar windowOnload = window.onload || function () {\n\n\t\t// 設定チェック\n\t\tvalidon.form = document.querySelector(validon.form)\n\t\tif(!validon.form){\n\t\t\tconsole.warn('Validon can not set up. Please set exists form query.')\n\t\t\treturn false\n\t\t}\n\t\tif(!validon.config){\n\t\t\tconsole.warn('Validon can not set up. Please set config.')\n\t\t\treturn false\n\t\t}\n\n\t\t// 対象フォームがクリック不可になっていたら困るので戻し\n\t\tvalidon.form.style.pointerEvents = ''\n\n\t\t// submitイベント登録\n\t\tvar submitEvent = function(event){\n\t\t\t(event.preventDefault) ? event.preventDefault() : event.returnValue = false\n\t\t\tvalidon.send()\n\t\t}\n\t\tif (validon.form.addEventListener) {\n\t\t\tvalidon.form.addEventListener('submit', submitEvent, false)\n\t\t} else if (validon.form.attachEvent) {\n\t\t\tvalidon.form.attachEvent('onsubmit', submitEvent)\n\t\t}\n\n\t\t// 要素ごとのイベント発火が有効の場合、各要素に `onChange` が登録され都度バリデートされるようになる。\n\t\t// ※要素ごとに設定も可能（例： data-validon-on='change,keydown' ← カンマで複数指定可\n\t\tif(validon.eachfire || validon.form.querySelectorAll('[data-validon-on]').length) {\n\t\t\tvar elems = validon.eachfire\n\t\t\t\t? validon.form.querySelectorAll('[name]')\n\t\t\t\t: validon.form.querySelectorAll('[data-validon-on]')\n\t\t\tfor(var i=0; i<elems.length; i++) {\n\t\t\t\tvar eventName = elems[i].getAttribute('data-validon-on')\n\t\t\t\tif(!eventName) {\n\t\t\t\t\tif(\n\t\t\t\t\t\telems[i].type==='radio' ||\n\t\t\t\t\t\telems[i].type==='checkbox' ||\n\t\t\t\t\t\telems[i].type==='file' ||\n\t\t\t\t\t\telems[i].tagName==='SELECT'\n\t\t\t\t\t) {\n\t\t\t\t\t\teventName = 'change'\n\t\t\t\t\t} else {\n\t\t\t\t\t\teventName = 'blur'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar eventNames = eventName.split(/\\s*\\,\\s*/)\n\t\t\t\tfor(var j=0; j<eventNames.length; j++) {\n\t\t\t\t\tvar event = eventNames[j];\n\t\t\t\t\tif (elems[i].addEventListener) {\n\t\t\t\t\t\telems[i].addEventListener(event, function(e){ validon.send(this.name) }, false)\n\t\t\t\t\t} else if (elems[i].attachEvent) {\n\t\t\t\t\t\telems[i].attachEvent('on'+event, function(e){ validon.send(e.srcElement.name) })\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\twindow.onload = function () { windowOnload(); };\n}\n\n/**\n * メソッド\n */\nValidon.prototype = {\n\n\t/**\n\t * PHPにデータを送信してバリデート実行\n\t *\n\t * - 引数空ならsubmit実行（全要素をバリデート対象にする\n\t * - 引数に文字列が入っている場合はnameとしてバリデート対象にする\n\t * - 引数に複数の文字列が配列で入っている場合は複数のnameとしてバリデート対象にする\n\t */\n\tsend: function(elems, callback){\n\t\tvar validon = this\n\t\tvar json = {\n\t\t\tconfig: this.config\n\t\t};\n\n\t\t// フック：startFunc\n\t\tif(validon.startFunc && 'function' === typeof validon.startFunc) {\n\t\t\tif(false === validon.startFunc(json)) return false\n\t\t}\n\n\t\t// submit中は要素を全てクリックできないように\n\t\tif(typeof elems === 'undefined') validon.form.style.pointerEvents = 'none'\n\n\t\t// 値まとめ\n\t\tjson.params = []\n\t\tvar params = {}\n\t\tvar elements = validon.form.querySelectorAll('[name]')\n\t\tvar hasFileApi = !!window.File;\n\t\tfor(var i=0; i<elements.length; i++) {\n\t\t\tvar name = elements[i].getAttribute('name')\n\t\t\tif('undefined'!==typeof params[name]) continue\n\t\t\t// ラジオボタン\n\t\t\tif(elements[i].type==='radio') {\n\t\t\t\tvar lump = validon.form.querySelectorAll('[name=\"'+name+'\"]')\n\t\t\t\tparams[name] = null\n\t\t\t\tfor(var j=0; j<lump.length; j++) {\n\t\t\t\t\tif(lump[j].checked) {\n\t\t\t\t\t\tparams[name] = lump[j].value\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// チェックボックス\n\t\t\telse if(elements[i].type==='checkbox') {\n\t\t\t\tvar lump = validon.form.querySelectorAll('[name=\"'+name+'\"]')\n\t\t\t\tparams[name] = new Array();\n\t\t\t\tfor(var j=0; j<lump.length; j++) {\n\t\t\t\t\tif(lump[j].checked) {\n\t\t\t\t\t\tparams[name].push(lump[j].value)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// セレクトプルダウン\n\t\t\telse if(elements[i].tagName==='SELECT') {\n\t\t\t\tvar lump = validon.form.querySelectorAll('[name=\"'+name+'\"] option')\n\t\t\t\tif(name.match(/\\]$/)) {\n\t\t\t\t\t// マルチ\n\t\t\t\t\tparams[name] = new Array();\n\t\t\t\t\tfor(var j=0; j<lump.length; j++) {\n\t\t\t\t\t\tif(lump[j].selected) {\n\t\t\t\t\t\t\tparams[name].push(lump[j].value)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// シングル\n\t\t\t\t\tparams[name] = null\n\t\t\t\t\tfor(var j=0; j<lump.length; j++) {\n\t\t\t\t\t\tif(lump[j].selected) {\n\t\t\t\t\t\t\tparams[name] = lump[j].value\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// ファイル選択（FileAPIが使用できる場合は name,type,size をセットする）\n\t\t\telse if(elements[i].type==='file' && hasFileApi) {\n\t\t\t\tvar element = validon.form.querySelector('[name=\"'+name+'\"]')\n\t\t\t\tvar files = new Array();\n\t\t\t\tfor(var j=0; j<element.files.length; j++){\n\t\t\t\t\tfiles.push({\n\t\t\t\t\t\tname: element.files[j]['name'],\n\t\t\t\t\t\ttype: element.files[j]['type'],\n\t\t\t\t\t\tsize: element.files[j]['size'],\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tif(name.match(/\\]$/)) {\n\t\t\t\t\tparams[name] = files\n\t\t\t\t} else {\n\t\t\t\t\tparams[name] = files[0]\n\t\t\t\t}\n\t\t\t}\n\t\t\t// その他の要素\n\t\t\telse {\n\t\t\t\tif(name.match(/\\]$/)) {\n\t\t\t\t\tvar lump = validon.form.querySelectorAll('[name=\"'+name+'\"]')\n\t\t\t\t\tparams[name] = new Array();\n\t\t\t\t\tfor(var j=0; j<lump.length; j++) {\n\t\t\t\t\t\tparams[name].push(lump[j].value)\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tparams[name] = elements[i].value\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tjson.params = params\n\n\t\t// 対象要素まとめ\n\t\tjson.targets = []\n\t\tjson.isSubmit = false\n\t\tif(typeof elems === 'undefined') {\n\t\t\t// submitバリデートの場合全ての値\n\t\t\tjson.isSubmit = true\n\t\t\tjson.targets = Object.keys(json.params)\n\t\t} else if(typeof elems ==='string') {\n\t\t\t// 個別バリデート：単体の場合（要素ごとのバリデート発火など）\n\t\t\tjson.targets.push(elems)\n\t\t} else if(elems instanceof Array) {\n\t\t\t// 個別バリデート：複数の場合（直接jsからvalidate()実行など）\n\t\t\tfor(var i=0; i<elems.length; i++) {\n\t\t\t\tjson.targets.push(elems[i])\n\t\t\t}\n\t\t}\n\n\t\t// フック：beforeFunc\n\t\tif(validon.beforeFunc && 'function' === typeof validon.beforeFunc) {\n\t\t\tif(false === validon.beforeFunc(json)) {\n\t\t\t\t// クリック不可を戻してイベントキャンセル\n\t\t\t\tif(typeof elems === 'undefined') validon.form.style.pointerEvents = ''\n\t\t\t\treturn false\n\t\t\t}\n\t\t}\n\n\t\t// Ajax\n\t\tvar xhr = new XMLHttpRequest();\n\t\txhr.onreadystatechange = function()\n\t\t{\n\t\t\tif(4 === this.readyState) {\n\t\t\t\tif(200 === this.status) {\n\t\t\t\t\tjson = this.response\n\t\t\t\t\tif('undefined' === typeof json || 'string' === typeof json) {\n\t\t\t\t\t\tjson = JSON.parse(this.responseText)\n\t\t\t\t\t}\n\n\t\t\t\t\t// フック：afterFunc\n\t\t\t\t\tif(validon.afterFunc && 'function' === typeof validon.afterFunc) {\n\t\t\t\t\t\tif(false === validon.afterFunc(json)) {\n\t\t\t\t\t\t\t// クリック不可を戻してイベントキャンセル\n\t\t\t\t\t\t\tif(typeof elems === 'undefined') validon.form.style.pointerEvents = ''\n\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// ターゲットのみ値の変更があれば反映する\n\t\t\t\t\tif(json.changes && json.changes.length) {\n\t\t\t\t\t\t\tfor(var i=0; i<json.changes.length; i++) {\n\t\t\t\t\t\t\tvar name = json.changes[i]\n\t\t\t\t\t\t\tvar elem = validon.form.querySelector('[name=\"'+name+'\"]')\n\t\t\t\t\t\t\tif(\n\t\t\t\t\t\t\t\t'INPUT' === elem.tagName &&\n\t\t\t\t\t\t\t\t('radio' === elem.getAttribute('type') || 'checkbox' === elem.getAttribute('type'))\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tvar elems = validon.form.querySelectorAll('[name=\"'+name+'\"]')\n\t\t\t\t\t\t\t\tfor(var j=0; j<elems.length; j++) {\n\t\t\t\t\t\t\t\t\telems[j].checked = -1 !== json.params[name].indexOf(elems[j].value)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if('SELECT' === elem.tagName) {\n\t\t\t\t\t\t\t\tvar options = elem.querySelectorAll('option')\n\t\t\t\t\t\t\t\tfor(var j=0; j<options.length; j++) {\n\t\t\t\t\t\t\t\t\toptions[j].selected = -1 !== json.params[name].indexOf(options[j].value)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\telem.value = json.params[name]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// ターゲットのみエラーがあれば反映する\n\t\t\t\t\tif(json.targets && json.targets.length) {\n\t\t\t\t\t\tfor(var i=0; i<json.targets.length; i++) {\n\t\t\t\t\t\t\tvar name = json.targets[i]\n\t\t\t\t\t\t\tvar elem = validon.form.querySelector('[name=\"'+name+'\"]')\n\t\t\t\t\t\t\tvar errorholder = validon.form.querySelectorAll('[data-validon-errorholder=\"'+name+'\"]')\n\t\t\t\t\t\t\tif(!errorholder.length) {\n\t\t\t\t\t\t\t\tvar parent = elem.parentNode\n\t\t\t\t\t\t\t\twhile (parent.tagName !== validon.errorgroup.toUpperCase()) {\n\t\t\t\t\t\t\t\t\tparent = parent.parentNode;\n\t\t\t\t\t\t\t\t\tif('undefined' === typeof parent.tagName) {\n\t\t\t\t\t\t\t\t\t\tparent = elem.parentNode\n\t\t\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\terrorholder = document.createElement('div')\n\t\t\t\t\t\t\t\terrorholder.setAttribute('data-validon-errorholder', name)\n\t\t\t\t\t\t\t\tif(validon.errorposition === 'append') {\n\t\t\t\t\t\t\t\t\tparent.appendChild(errorholder)\n\t\t\t\t\t\t\t\t} else if(validon.errorposition === 'prepend') {\n\t\t\t\t\t\t\t\t\tparent.insertBefore(errorholder, parent.childNodes[0]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\terrorholder = new Array(errorholder)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar message = ''\n\t\t\t\t\t\t\tif(json.errors && 'undefined' !== typeof json.errors[name]) {\n\t\t\t\t\t\t\t\tmessage = validon.errortag.replace(/\\$message/, json.errors[name])\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor(var j=0; j<errorholder.length; j++) {\n\t\t\t\t\t\t\t\terrorholder[j].innerHTML = message\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// 第二引数に関数が指定されていたらここで実行\n\t\t\t\t\tif(callback && 'function' === typeof callback) {\n\t\t\t\t\t\tcallback(json)\n\t\t\t\t\t}\n\n\t\t\t\t\t// フック：finsihFunc\n\t\t\t\t\tif(validon.finishFunc && 'function' === typeof validon.finishFunc) {\n\t\t\t\t\t\tif(false === validon.finishFunc(json)) {\n\t\t\t\t\t\t\t// クリック不可を戻してイベントキャンセル\n\t\t\t\t\t\t\tif(typeof elems === 'undefined') validon.form.style.pointerEvents = ''\n\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// エラーが一つも無ければsubmitする（isSubmit時のみ）\n\t\t\t\t\tif(!json.errors && json.isSubmit) validon.form.submit()\n\t\t\t\t\telse {\n\t\t\t\t\t\t// エラーがある場合はsubmit中のクリック不可を戻す\n\t\t\t\t\t\tif(typeof elems === 'undefined') validon.form.style.pointerEvents = ''\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\txhr.open('POST', validon.urlPath+'validon.php')\n\t\txhr.setRequestHeader('Content-Type', 'application/json')\n\t\txhr.responseType = 'json'\n\t\txhr.send(JSON.stringify(json))\n\n\t\treturn this\n\t}\n}\n\n/**\n * Object.keys Polyfill\n * http://tokenposts.blogspot.com/2012/04/javascript-objectkeys-browser.html\n */\nif (!Object.keys) Object.keys = function(o) {\n\tif (o !== Object(o))\n\t\tthrow new TypeError('Object.keys called on a non-object');\n\tvar k=[],p;\n\tfor (p in o) if (Object.prototype.hasOwnProperty.call(o,p)) k.push(p);\n\treturn k;\n}\n\n/**\n * Array.indexOf Polyfill\n * https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf#Polyfill\n */\nif (!Array.prototype.indexOf) Array.prototype.indexOf = (function (Object, max, min) {\n\t\"use strict\";\n\treturn function indexOf(member, fromIndex) {\n\t\tif (this === null || this === undefined) throw TypeError(\"Array.prototype.indexOf called on null or undefined\");\n\n\t\tvar that = Object(this), Len = that.length >>> 0, i = min(fromIndex | 0, Len);\n\t\tif (i < 0) i = max(0, Len + i); else if (i >= Len) return -1;\n\n\t\tif (member === void 0) {\n\t\t\tfor (; i !== Len; ++i) if (that[i] === void 0 && i in that) return i; // undefined\n\t\t} else if (member !== member) {\n\t\t\tfor (; i !== Len; ++i) if (that[i] !== that[i]) return i; // NaN\n\t\t} else for (; i !== Len; ++i) if (that[i] === member) return i; // all else\n\n\t\treturn -1; // if the value was not found, then return -1\n\t};\n})(Object, Math.max, Math.min);\n"]}