{"version":3,"sources":["validon.js"],"names":["__validonUrlPath","document","currentScript","src","getElementsByTagName","length","replace","RegExp","location","origin","Validon","validon","eachfire","opt","errorposition","beforeFunc","afterFunc","finishFunc","errorgroup","urlPath","startFunc","windowOnload","window","onload","form","querySelector","console","warn","event","preventDefault","send","attachEvent","returnValue","addEventListener","submitEvent","elems","eventName","querySelectorAll","i","getAttribute","eventNames","name","split","j","e","this","srcElement","prototype","callback","json","config","params","elements","hasFileApi","lump","checked","type","value","tagName","element","files","size","Array","match","targets","isSubmit","Object","push","xhr","onreadystatechange","readyState","status","XMLHttpRequest","response","JSON","parse","responseText","changes","elem","options","selected","indexOf","errorholder","parent","parentNode","createElement","setAttribute","appendChild","toUpperCase","childNodes","errortag","errors","innerHTML","insertBefore","message","responseType","stringify","submit","open","setRequestHeader","o","keys","p","k","hasOwnProperty","call","max","min","member","fromIndex","TypeError","that","Len","Math"],"mappings":"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","file":"validon.js","sourcesContent":["\n/**\n * set url path\n */\nvar __validonUrlPath = (\n\tdocument.currentScript\n\t\t? document.currentScript.src\n\t\t: document.getElementsByTagName('script')[document.getElementsByTagName('script').length-1].src\n\t)\n\t.replace(new RegExp('^'+location.origin), '')\n\t.replace(/[^\\/]+$/, '')\n;\n\n/**\n * コンストラクタ\n */\nfunction Validon(opt)\n{\n\tvar validon = this;\n\n\t// オプションセット\n\tvalidon.form          = opt.form\n\tvalidon.config        = opt.config\n\tvalidon.eachfire      = opt.eachfire || false\n\tvalidon.errorgroup    = opt.errorgroup || 'section'\n\tvalidon.errorposition = opt.errorposition || 'append'\n\tvalidon.errortag      = opt.errortag || '<div class=\"error\">$message</div>'\n\tvalidon.startFunc     = opt.startFunc  // 開始してすぐ実行する関数\n\tvalidon.beforeFunc    = opt.beforeFunc // json送信直前に実行する関数\n\tvalidon.afterFunc     = opt.afterFunc  // json受信直後に実行する関数\n\tvalidon.finishFunc    = opt.finishFunc // 処理完了後に実行する関数\n\n\t// URLパス設定\n\tvalidon.urlPath = __validonUrlPath\n\n\t// オンロードセット\n\tvar windowOnload = window.onload || function () {\n\n\t\t// 設定チェック\n\t\tvalidon.form = document.querySelector(validon.form)\n\t\tif(!validon.form){\n\t\t\tconsole.warn('Validon can not set up. Please set exists form query.')\n\t\t\treturn false\n\t\t}\n\t\tif(!validon.config){\n\t\t\tconsole.warn('Validon can not set up. Please set config.')\n\t\t\treturn false\n\t\t}\n\n\t\t// submitイベント登録\n\t\tvar submitEvent = function(event){\n\t\t\t(event.preventDefault) ? event.preventDefault() : event.returnValue = false\n\t\t\tvalidon.send()\n\t\t}\n\t\tif (validon.form.addEventListener) {\n\t\t\tvalidon.form.addEventListener('submit', submitEvent, false)\n\t\t} else if (validon.form.attachEvent) {\n\t\t\tvalidon.form.attachEvent('onsubmit', submitEvent)\n\t\t}\n\n\t\t// 要素ごとのイベント発火が有効の場合、各要素に `onChange` が登録され都度バリデートされるようになる。\n\t\t// ※要素ごとに設定も可能（例： data-validon-on='change,keydown' ← カンマで複数指定可\n\t\tif(validon.eachfire) {\n\t\t\tvar elems = validon.form.querySelectorAll('[name]')\n\t\t\tfor(var i=0; i<elems.length; i++) {\n\t\t\t\tvar eventName = elems[i].getAttribute('data-validon-on')\n\t\t\t\tif(!eventName) {\n\t\t\t\t\tif(\n\t\t\t\t\t\telems[i].type==='radio' ||\n\t\t\t\t\t\telems[i].type==='checkbox' ||\n\t\t\t\t\t\telems[i].type==='file' ||\n\t\t\t\t\t\telems[i].tagName==='SELECT'\n\t\t\t\t\t) {\n\t\t\t\t\t\teventName = 'change'\n\t\t\t\t\t} else {\n\t\t\t\t\t\teventName = 'blur'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar eventNames = eventName.split(/\\s*\\,\\s*/)\n\t\t\t\tfor(var j=0; j<eventNames.length; j++) {\n\t\t\t\t\tvar event = eventNames[j];\n\t\t\t\t\tif (elems[i].addEventListener) {\n\t\t\t\t\t\telems[i].addEventListener(event, function(e){ validon.send(this.name) }, false)\n\t\t\t\t\t} else if (elems[i].attachEvent) {\n\t\t\t\t\t\telems[i].attachEvent('on'+event, function(e){ validon.send(e.srcElement.name) })\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\twindow.onload = function () { windowOnload(); };\n}\n\n/**\n * メソッド\n */\nValidon.prototype = {\n\n\t/**\n\t * PHPにデータを送信してバリデート実行\n\t *\n\t * - 引数空ならsubmit実行（全要素をバリデート対象にする\n\t * - 引数に文字列が入っている場合はnameとしてバリデート対象にする\n\t * - 引数に複数の文字列が配列で入っている場合は複数のnameとしてバリデート対象にする\n\t */\n\tsend: function(elems, callback){\n\t\tvar validon = this\n\t\tvar json = {\n\t\t\tconfig: this.config\n\t\t};\n\n\t\t// フック：startFunc\n\t\tif(validon.startFunc && 'function' === typeof validon.startFunc) {\n\t\t\tif(false === validon.startFunc(json)) return false\n\t\t}\n\n\t\t// 値まとめ\n\t\tjson.params = []\n\t\tvar params = {}\n\t\tvar elements = validon.form.querySelectorAll('[name]')\n\t\tvar hasFileApi = !!window.File;\n\t\tfor(var i=0; i<elements.length; i++) {\n\t\t\tvar name = elements[i].getAttribute('name')\n\t\t\tif('undefined'!==typeof params[name]) continue\n\t\t\t// ラジオボタン\n\t\t\tif(elements[i].type==='radio') {\n\t\t\t\tvar lump = validon.form.querySelectorAll('[name=\"'+name+'\"]')\n\t\t\t\tfor(var j=0; j<lump.length; j++) {\n\t\t\t\t\tif(lump[j].checked) {\n\t\t\t\t\t\tparams[name] = lump[j].value\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// チェックボックス\n\t\t\telse if(elements[i].type==='checkbox') {\n\t\t\t\tvar lump = validon.form.querySelectorAll('[name=\"'+name+'\"]')\n\t\t\t\tparams[name] = []\n\t\t\t\tfor(var j=0; j<lump.length; j++) {\n\t\t\t\t\tif(lump[j].checked) {\n\t\t\t\t\t\tparams[name].push(lump[j].value)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// セレクトプルダウン\n\t\t\telse if(elements[i].tagName==='SELECT') {\n\t\t\t\tvar lump = validon.form.querySelectorAll('[name=\"'+name+'\"] option')\n\t\t\t\tparams[name] = []\n\t\t\t\tfor(var j=0; j<lump.length; j++) {\n\t\t\t\t\tif(lump[j].selected) {\n\t\t\t\t\t\tparams[name].push(lump[j].value)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// ファイル選択（FileAPIが使用できる場合は name,type,size をセットする）\n\t\t\telse if(elements[i].type==='file' && hasFileApi) {\n\t\t\t\tvar element = validon.form.querySelector('[name=\"'+name+'\"]')\n\t\t\t\tvar files = new Array();\n\t\t\t\tfor(var j=0; j<element.files.length; j++){\n\t\t\t\t\tfiles.push({\n\t\t\t\t\t\tname: element.files[j]['name'],\n\t\t\t\t\t\ttype: element.files[j]['type'],\n\t\t\t\t\t\tsize: element.files[j]['size'],\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tif(name.match(/\\]$/)) {\n\t\t\t\t\tparams[name] = files\n\t\t\t\t} else {\n\t\t\t\t\tparams[name] = files[0]\n\t\t\t\t}\n\t\t\t}\n\t\t\t// その他の要素\n\t\t\telse {\n\t\t\t\tparams[name] = elements[i].value\n\t\t\t}\n\t\t}\n\t\tjson.params = params\n\n\t\t// 対象要素まとめ\n\t\tjson.targets = []\n\t\tjson.isSubmit = false\n\t\tif(typeof elems ==='undefined') {\n\t\t\t// submitバリデートの場合全ての値\n\t\t\tjson.isSubmit = true\n\t\t\tjson.targets = Object.keys(json.params)\n\t\t} else if(typeof elems ==='string') {\n\t\t\t// 個別バリデート：単体の場合（要素ごとのバリデート発火など）\n\t\t\tjson.targets.push(elems)\n\t\t} else if(elems instanceof Array) {\n\t\t\t// 個別バリデート：複数の場合（直接jsからvalidate()実行など）\n\t\t\tfor(var i=0; i<elems.length; i++) {\n\t\t\t\tjson.targets.push(elems[i])\n\t\t\t}\n\t\t}\n\n\t\t// フック：beforeFunc\n\t\tif(validon.beforeFunc && 'function' === typeof validon.beforeFunc) {\n\t\t\tif(false === validon.beforeFunc(json)) return false\n\t\t}\n\n\t\t// Ajax\n\t\tvar xhr = new XMLHttpRequest();\n\t\txhr.onreadystatechange = function()\n\t\t{\n\t\t\tif(4 === this.readyState && 200 === this.status) {\n\t\t\t\tjson = this.response\n\t\t\t\tif('undefined' === typeof this.response) {\n\t\t\t\t\tjson = JSON.parse(this.responseText)\n\t\t\t\t}\n\n\t\t\t\t// フック：afterFunc\n\t\t\t\tif(validon.afterFunc && 'function' === typeof validon.afterFunc) {\n\t\t\t\t\tif(false === validon.afterFunc(json)) return false\n\t\t\t\t}\n\n\t\t\t\t// ターゲットのみ値の変更があれば反映する\n\t\t\t\tif(json.changes && json.changes.length) {\n\t\t\t\t\tfor(var i=0; i<json.changes.length; i++) {\n\t\t\t\t\t\tvar name = json.changes[i]\n\t\t\t\t\t\tvar elem = validon.form.querySelector('[name=\"'+name+'\"]')\n\t\t\t\t\t\tif(\n\t\t\t\t\t\t\t'INPUT' === elem.tagName &&\n\t\t\t\t\t\t\t('checkdradiobox' === elem.getAttribute('type') || 'checkbox' === elem.getAttribute('type'))\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tvar elems = validon.form.querySelectorAll('[name=\"'+name+'\"]')\n\t\t\t\t\t\t\tfor(var j=0; j<elems.length; j++) {\n\t\t\t\t\t\t\t\telems[j].checked = -1 !== json.params[name].indexOf(elems[j].value)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if('SELECT' === elem.tagName) {\n\t\t\t\t\t\t\tvar options = elem.querySelectorAll('option')\n\t\t\t\t\t\t\tfor(var j=0; j<options.length; j++) {\n\t\t\t\t\t\t\t\toptions[j].selected = -1 !== json.params[name].indexOf(options[j].value)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\telem.value = json.params[name]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// ターゲットのみエラーがあれば反映する\n\t\t\t\tif(json.targets && json.targets.length) {\n\t\t\t\t\tfor(var i=0; i<json.targets.length; i++) {\n\t\t\t\t\t\tvar name = json.targets[i]\n\t\t\t\t\t\tvar elem = validon.form.querySelector('[name=\"'+name+'\"]')\n\t\t\t\t\t\tvar errorholder = validon.form.querySelectorAll('[data-validon-errorholder=\"'+name+'\"]')\n\t\t\t\t\t\tif(!errorholder.length) {\n\t\t\t\t\t\t\tvar parent = elem.parentNode\n\t\t\t\t\t\t\twhile (parent.tagName !== validon.errorgroup.toUpperCase()) {\n\t\t\t\t\t\t\t\tparent = parent.parentNode;\n\t\t\t\t\t\t\t\tif('undefined' === typeof parent.tagName) {\n\t\t\t\t\t\t\t\t\tparent = elem.parentNode\n\t\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\terrorholder = document.createElement('div')\n\t\t\t\t\t\t\terrorholder.setAttribute('data-validon-errorholder', name)\n\t\t\t\t\t\t\tif(validon.errorposition === 'append') {\n\t\t\t\t\t\t\t\tparent.appendChild(errorholder)\n\t\t\t\t\t\t\t} else if(validon.errorposition === 'prepend') {\n\t\t\t\t\t\t\t\tparent.insertBefore(errorholder, parent.childNodes[0]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\terrorholder = new Array(errorholder)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar message = ''\n\t\t\t\t\t\tif(json.errors && 'undefined' !== typeof json.errors[name]) {\n\t\t\t\t\t\t\tmessage = validon.errortag.replace(/\\$message/, json.errors[name])\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(var j=0; j<errorholder.length; j++) {\n\t\t\t\t\t\t\terrorholder[j].innerHTML = message\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// 第二引数に関数が指定されていたらここで実行\n\t\t\t\tif(callback && 'function' === typeof callback) {\n\t\t\t\t\tcallback(json)\n\t\t\t\t}\n\n\t\t\t\t// フック：finsihFunc\n\t\t\t\tif(validon.finishFunc && 'function' === typeof validon.finishFunc) {\n\t\t\t\t\tif(false === validon.finishFunc(json)) return false\n\t\t\t\t}\n\n\t\t\t\t// エラーが一つも無ければsubmitする（isSubmit時のみ）\n\t\t\t\tif(!json.errors && json.isSubmit) validon.form.submit()\n\t\t\t}\n\t\t}\n\t\txhr.open('POST', validon.urlPath+'validon.php')\n\t\txhr.setRequestHeader('Content-Type', 'application/json')\n\t\txhr.responseType = 'json'\n\t\txhr.send(JSON.stringify(json))\n\n\t\treturn this\n\t}\n}\n\n/**\n * Object.keys Polyfill\n * http://tokenposts.blogspot.com/2012/04/javascript-objectkeys-browser.html\n */\nif (!Object.keys) Object.keys = function(o) {\n\tif (o !== Object(o))\n\t\tthrow new TypeError('Object.keys called on a non-object');\n\tvar k=[],p;\n\tfor (p in o) if (Object.prototype.hasOwnProperty.call(o,p)) k.push(p);\n\treturn k;\n}\n\n/**\n * Array.indexOf Polyfill\n * https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf#Polyfill\n */\nif (!Array.prototype.indexOf) Array.prototype.indexOf = (function (Object, max, min) {\n\t\"use strict\";\n\treturn function indexOf(member, fromIndex) {\n\t\tif (this === null || this === undefined) throw TypeError(\"Array.prototype.indexOf called on null or undefined\");\n\n\t\tvar that = Object(this), Len = that.length >>> 0, i = min(fromIndex | 0, Len);\n\t\tif (i < 0) i = max(0, Len + i); else if (i >= Len) return -1;\n\n\t\tif (member === void 0) {\n\t\t\tfor (; i !== Len; ++i) if (that[i] === void 0 && i in that) return i; // undefined\n\t\t} else if (member !== member) {\n\t\t\tfor (; i !== Len; ++i) if (that[i] !== that[i]) return i; // NaN\n\t\t} else for (; i !== Len; ++i) if (that[i] === member) return i; // all else\n\n\t\treturn -1; // if the value was not found, then return -1\n\t};\n})(Object, Math.max, Math.min);\n"]}